# NaiBotAssistant 软件开发需求规格说明书（SRS）

## 1. 引言

### 1.1 项目背景

NaiBotAssistant 是一款面向 StableDiffusion（NovelAI 模型）用户的提示词管理工具，旨在解决自定义提示词关键字组合、录入、管理与输出的效率问题，提升 AI 绘图工作流的便捷性。

### 1.2 文档目的

本文档详细定义 NaiBotAssistant 的功能需求、非功能需求、技术架构及部署方案，作为开发、测试、验收及维护的核心依据。

### 1.3 适用范围

- 开发团队：前后端开发、测试工程师
- 产品与运维：产品经理、运维工程师
- 最终用户：StableDiffusion（NovelAI 模型）使用者

---

## 2. 总体描述

### 2.1 产品用途

用于在 StableDiffusion（NovelAI 模型下）进行自定义提示词关键字组合、录入、管理、输出。

### 2.2 技术栈

- **架构模式**：前后端分离
- **后端**：Python（向下兼容 3.8）Flask+ SQLite 数据库，若有大量json处理，使用orjson代替标准库。
- **前端**：HTML5 + CSS3 + JavaScript，支持响应式适配手机、电脑等多终端

### 2.3 核心功能模块

1. 主页入口
2. 词条录入
3. 词条组合输出
4. 批量管理
5. 备份管理
6. 配置与部署

---

## 3. 具体需求

### 3.1 模块1：主页入口

- **功能描述**：提供系统核心功能的统一入口页。
- **功能点**：
  1. 提供四个功能入口：词条录入、词条组合输出、词条批量管理、备份管理，点击后跳转至对应页面。
  2. 页脚包含 GitHub 项目地址超链接。
- **用户界面**：简洁直观的导航布局，适配不同设备尺寸。

---

### 3.2 模块2：词条录入

- **功能描述**：支持用户录入新的提示词词条并存储到数据库。
- **功能点**：
  1. 输入项：分类（必填）、名称（必填）、译文（必填）、注释（可选）。
  2. 录入校验：前三项未填写时，点击录入按钮提示报错。
  3. 操作反馈：录入按钮下方显示消息提示，告知录入成功或报错详情。
  4. 分类支持：下拉选择已有分类或手动输入新分类。
  5. 数据存储：录入数据传递并存储到 SQLite 数据库。
  6. 导航：页面底部提供“返回首页”按钮。
- **约束**：分类、名称、译文为必填项，不能为空。

---

### 3.3 模块3：词条组合输出

- **功能描述**：支持用户按分类选择词条，组合生成提示词文本并复制使用。
- **功能点**：
  1. **分类选择下拉框**：列出数据库中所有分类。
  2. **词条列表**：根据所选分类列出可选词条，每条词条附带复选框；显示格式为“名称（备注）”；切换分类后，复选框选中状态保持不变。
  3. **组合词条预览**：将选中词条的译文以英文逗号分隔展示；取消复选框时，对应译文从预览中移除。
  4. **命令前缀复选框**：控制是否在组合词条文本前添加“Nai”命令前缀。
  5. **复制到剪贴板**：将预览文本一键复制到系统剪贴板。
  6. 导航：页面底部提供“返回首页”按钮。
- **用户体验**：词条选择状态持久化，避免重复操作。

---

### 3.4 模块4：批量管理

- **功能描述**：支持对已有词条进行批量查看、编辑、删除及新增操作。
- **功能点**：
  1. **分类筛选**：通过下拉框选择分类，筛选对应词条。
  2. **词条列表**：按中文拼音排序展示词条；支持分页，每页最多 100 条。
  3. **编辑功能**：可修改词条的分类、名称、译文、注释；若是修改分类，保存修改后，词条自动移动到新分类下。
  4. **操作按钮**：保存修改、删除词条、录入新词条。
  5. 数据刷新：保存后自动刷新列表并重新按汉语拼音排序。
- **约束**：修改分类后，词条归属自动更新。

---

### 3.5 模块5：备份管理

- **功能描述**：支持数据备份与恢复，保障数据安全。
- **功能点**：
  1. **备份下载**：支持导出为 CSV 或 SQLite db 文件格式。
  2. **备份恢复**：支持从 CSV 或 db 文件恢复数据；提供两种恢复模式：
     - 增量恢复：在现有数据基础上追加备份数据。
     - 覆盖恢复：用备份数据完全覆盖现有数据库。
- **数据安全**：恢复操作前需二次确认，避免误操作。

---

### 3.6 其他配置与部署

- **后端配置**：
  - 通过 `appsettings.json` 配置文件可设置日志等级、服务端口号。
- **部署脚本**：
  - 提供可交互的 Bash 部署脚本，支持：
    - 安装（以守护进程方式运行）
    - 重启、更新、卸载服务
    - 配置文件修改
- **运维友好**：脚本简化部署流程，降低运维成本。

---

## 4. 非功能需求

### 4.1 性能需求

- 页面加载时间 ≤ 2 秒（在常规网络环境下）。
- 词条列表分页加载响应时间 ≤ 500ms。
- 备份/恢复操作：10000 条数据处理时间 ≤ 30 秒。

### 4.2 可用性需求

- 支持 Chrome、Edge、Firefox 等主流浏览器；移动端适配 iOS Safari、Android Chrome。
- 操作反馈明确，错误提示友好，避免用户困惑。

### 4.3 可维护性需求

- 代码结构清晰，遵循前后端分离规范。
- 配置与业务逻辑分离，便于后续扩展与维护。

---

## 5. 验收标准

1. 所有功能模块按需求实现，无阻塞性 Bug。
2. 数据录入、修改、删除、备份恢复操作数据一致性。
3. 响应式布局在手机、平板、电脑端显示正常。
4. 部署脚本可在主流 Linux 发行版上正常执行。

---

## 6. 附录

- 术语定义：
  - **NovelAI 模型**：StableDiffusion 的一种特定模型，常用于生成二次元风格图像。
  - **提示词（Prompt）**：用于引导 AI 生成图像的文本描述。
- 参考资料：
  - StableDiffusion 官方文档
  - Python 3.8+ 开发规范
  - SQLite 数据库设计规范
